\documentclass[12pt,a4paper,twoside,openright,BCOR10mm,headsepline,titlepage,abstracton,chapterprefix,final]{scrreprt}

\usepackage{ae}
\usepackage[ngerman, english]{babel}
%\usepackage{SIunits}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{xcolor}
\usepackage{setspace}
\usepackage{dsfont}

% load hyperref as the last package to avoid redefinitions of e.g. footnotes after hyperref invokation

\RequirePackage{ifpdf}  % flag for pdf or dvi backend
\ifpdf
  \usepackage[pdftex]{graphicx}
  \usepackage[pdftitle={RTFM on Imaging Theory and Basics of Optical Raytracing},%
              pdfsubject={},%
              pdfauthor={M. Esslinger, J. Hartung, U. Lippmann},%
              pdfkeywords={},%
              bookmarks=true,%
%              colorlinks=true,%
              urlcolor=blue,%
              pdfpagelayout=TwoColumnRight,%
              pdfpagemode=UseNone,%
              pdfstartview=Fit,%
	      pdfpagelabels,
              pdftex]{hyperref}
\else
  \usepackage[dvips]{graphicx}
  \usepackage[colorlinks=false,dvips]{hyperref}
\fi
%\DeclareGraphicsRule{.jpg}{eps}{.jpg}{`convert #1 eps:-}

\usepackage{ae}
%\usepackage[ngerman, english]{babel}

%\usepackage{SIunits}
\newcommand\elementarycharge{\textrm{e}}
\newcommand\sccm{\textrm{sccm}}
\newcommand\mbar{\milli\textrm{bar}}


\usepackage{amsmath}
%\usepackage{amssymb}
\usepackage{setspace}

%\widowpenalty = 1000


\newcommand*{\doi}[1]{\href{https://doi.org/\detokenize{#1}}{doi: \detokenize{#1}}}

\newcommand\Vector[1]{{\mathbf{#1}}}
%\newcommand\Vector[1]{{\vec{#1}}}

\newcommand\vacuum{0}

\newcommand\location{r}
\newcommand\Location{\Vector{r}}


\newcommand\wavenumber{k}
\newcommand\vacuumWavenumber{\wavenumber_{\vacuum}}
\newcommand\Wavevector{\Vector{\wavenumber}}

\newcommand\Nabla{\Vector{\nabla}}
\newcommand\Laplace{\Delta}
\newcommand\timederivative[1]{\dot{{#1}}}
\newcommand\Tensor[1]{\hat{#1}}
\newcommand\conjugate[1]{\overline{#1}}
\newcommand\transpose[1]{#1^{T}}
\newcommand\Norm[1]{\left| #1 \right|}
\newcommand{\ket}[1]{\left\vert{#1}\right\rangle}
\newcommand{\bra}[1]{\left\langle{#1}\right\vert}
\newcommand{\braket}[2]{\left\langle{#1}\vert{#2}\right\rangle}
\newcommand{\bracket}[1]{\left\langle{#1}\right\rangle}

\newcommand{\scpm}[2]{(#1\,\cdot\,#2)}

\newcommand\unittensor{\mathds{1}}

\newcommand\Greenfunction{\Tensor{G}}

\newcommand\scalarEfield{E}
\newcommand\scalarBfield{B}
\newcommand\scalarHfield{H}
\newcommand\scalarDfield{D}
\newcommand\Efield{\Vector{\scalarEfield}}
\newcommand\Bfield{\Vector{\scalarBfield}}
\newcommand\Hfield{\Vector{\scalarHfield}}
\newcommand\Dfield{\Vector{\scalarDfield}}

\newcommand\permeability{\Tensor{\scalarpermeability}}
\newcommand\vacuumpermeability{\scalarpermeability_{\vacuum}}
\newcommand\scalarpermeability{\mu}
\newcommand\scalarrelativepermeability{\mu_{rel}}
\newcommand\relativepermeability{\Tensor{\mu}_{rel}}

\newcommand\permittivity{\Tensor{\scalarpermittivity}}
\newcommand\vacuumpermittivity{\scalarpermittivity_{\vacuum}}
\newcommand\scalarrelativepermittivity{\epsilon}
\newcommand\relativepermittivity{\Tensor{\scalarrelativepermittivity}}
\newcommand\scalarpermittivity{\varepsilon}

\newcommand\conductivity{\Tensor{\sigma}}
\newcommand\susceptibility{\Tensor{\chi}}
\newcommand\currentdensity{\Vector{j}}
\newcommand\chargedensity{\rho}
\newcommand\PoyntingVector{\Vector{S}}

\newcommand\ordi{\text{ord}}
\newcommand\eo{\text{eo}}

\newcommand\materialone{I}
\newcommand\materialtwo{{II}}

\newcommand{\kpa}[1]{{\wavenumber_{\parallel#1}}}
\newcommand\tr{\text{tr}}

\newcommand{\timeavg}[1]{{\langle\,#1\,\rangle}}

\newcommand{\remark}[1]{{\color{red}$\blacksquare$}\footnote{{\color{red}#1}}}
\newcommand{\chk}[1]{\color{green}{$\checkmark$#1}}

\newcommand{\orderof}[1]{\mathcal{O}(#1)}

\newcommand\ppol{p}
\newcommand\spol{s}
\newcommand\normconst{N}

\newcommand\kilogram{\textrm{kg}}
\newcommand\meter{\textrm{m}}
\newcommand\second{\textrm{s}}
\newcommand\ampere{\textrm{A}}
\newcommand\volt{\textrm{V}}
\newcommand\watt{\textrm{W}}
\newcommand\tesla{\textrm{T}}

\newcommand\totald{\textrm{d}}
\newcommand\pilot{\textrm{pilot}}

\newcommand\im{\textrm{im}}
\newcommand\obj{\textrm{obj}}
\newcommand\tot{\textrm{tot}}


\begin{document}

\section{Solving a Cubic Equation}

\subsection{The Problem}
We are interested in solutions $x$ of the cubic equation
\begin{eqnarray}
 a x^3 + b x^2 + c x + d = 0
\end{eqnarray}
where the coefficients $a,b,c,d$ are complex valued.

\subsection{Strategy}
Rotate the coordinate system until the equation gets dizzy.

\subsection{Depressing the Equation}
We divide the equation by $a$, so that the leading coefficient becomes $1$.
\begin{eqnarray}
 x^3 + \frac{b}{a} x^2 + \frac{c}{a} x + \frac{d}{a} = 0
\end{eqnarray}
The we apply a linear Tschirnhaus coordinate transformation $x = z + e$.
\begin{eqnarray}
z^3 + 3 e z^2 + 3 e^2 z + e^3 +
\frac{b}{a} z^2 + 2 \frac{b}{a} ez + \frac{b}{a} e^2 +
\frac{c}{a} z + \frac{c}{a} e +
\frac{d}{a}
= 0
\end{eqnarray}
We choose $e = -\frac{b}{3a}$ in a way that the quadratic coefficient vanishes.
\begin{eqnarray}
z^3 + p z + q &=& 0 \label{eq:cubic_depressed}
\\
p &=& 3 e^2 z + 2 \frac{b}{a} ez + \frac{c}{a} z
\\
q &=& e^3 + \frac{b}{a} e^2 + \frac{c}{a} e + \frac{d}{a}
\end{eqnarray}
The cubic equation without quadratic coefficient is called depressed cubic equation.

\subsection{The Cardano Formulas}
We start from the depressed cubic equation 
\ref{eq:cubic_depressed}
and substitute
\begin{eqnarray}
 z = u - \frac{p}{3u}
\end{eqnarray}
For each $z \in \mathbb{C}$,
a value for $u$ can be found to represent this $z$.
The inverse, however, is not unique,
$u = \frac{z}{2} \pm \sqrt{\frac{z^2}{4} + \frac{p}{3}}$,
so the substitution is not bijective.
We abbreviate
\begin{eqnarray}
 v = - \frac{p}{3u}
\end{eqnarray}
such that
\begin{eqnarray}
 z   &=& u+v
\end{eqnarray}
We insert the substitution into out depressed cubic equation
\begin{eqnarray}
 (u+v)^3 + p (u+v) + q &=& 0
 \\
 u^3 + v^3 + q &=& 0 \label{eq:cubic_u3_v3_equation}
 \\
 u^3 - \frac{p^3}{27 u^3} + q &=& 0
\end{eqnarray}
We multiply both sides with $u^3$
(We may do this, as $u=0$ represents a non-existent, divergent $z$).
\begin{eqnarray}
 u^6 + q u^3 - \frac{p^3}{27} &=& 0
\end{eqnarray}
The solutions are
\begin{eqnarray}
 u^3 &=& - \frac{q}{2} \pm \sqrt{\Delta}\\
 \Delta &=& \left(\frac{q}{2}\right)^2 + \left(\frac{p}{3}\right)^3
\end{eqnarray}
$\Delta$ is called discriminant of the cubic equation.
From equation \ref{eq:cubic_u3_v3_equation} we find that the corresponding $v$ value is
\begin{eqnarray}
 v^3 &=& - \frac{q}{2} \mp \sqrt{\Delta}
\end{eqnarray}
Which is the same as the solution for $u^3$, but with the $\pm$ sign flipped.
Both solutions for $u^3$ will result in the same $z=u+v$. 
We choose arbitrarily one solution branch
\begin{eqnarray}
 u^3 &=& - \frac{q}{2} + \sqrt{\Delta}
\end{eqnarray}
The 3 complex valued roots can easily be extracted from $u^3$, leading to the final solution:

\subsection{Solution of the Depressed Cubic Equation}
\begin{eqnarray}
  z^3 + p z + q &=& 0
  \\
  z &=& u - \frac{p}{3u} 
  \\
  u &=& \left( \sqrt[3]{- \frac{q}{2} + \sqrt{\Delta}} \right) 
  \cdot \exp\left(i\frac{2\pi}{3} n\right)
  \\
  && n \in \{ 0,1,2 \} \nonumber
  \\
  \Delta &=& \left(\frac{q}{2}\right)^2 + \left(\frac{p}{3}\right)^3
\end{eqnarray}

\subsection{Special Cases}
Numerically, it is hard to tell whether a coefficient is zero or just close to. This section is added for completeness and to assist analytic investigations.

\begin{itemize}
 \item $\Delta > 0$ and $p,q \in \mathbb{R}$\\
       There is exactly one real solution.
       The other two solutions are complex.
 \item $\Delta=0$ and $p=0$ \\
       This means $q=0$ and $z^3=0$.
       There is one real solution with multiplicity 3.
 \item $\Delta = 0$ and $p\neq0$ and $p,q\in\mathbb{R}$ \\
       There are two real solutions,
       one with multiplicity 1 and one with multiplicity 2.
 \item $\Delta < 0$ and $p,q \in \mathbb{R}$\\
       This case is called \emph{casus irreducibilis}.
       It has three different real solutions.
       The $u$ values they are constructed from, however,
       are complex.
\end{itemize}




\end{document}
